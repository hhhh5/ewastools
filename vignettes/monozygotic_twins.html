<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jonathan Heiss" />

<meta name="date" content="2018-06-11" />

<title>Showcase: monozygotic twins</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Showcase: monozygotic twins</h1>
<h4 class="author"><em>Jonathan Heiss</em></h4>
<h4 class="date"><em>2018-06-11</em></h4>



<style>
body{ font-size: 12pt; text-align: justify; }
p.caption {text-align: justify; font-style: italic; margin-left: 8mm;}
</style>
<p><em>This vignette demonstrates the use of the ewastools package on a public available 450K dataset, with a focus on the implemented quality checks for identifying failed assays, mislabeled or contaminated samples. ewastools provides also functions for preprocessing (dye bias correction, normalization) and estimation of leukocyte composition.</em></p>
<p>Download and parse the metadata for the GSE61496 dataset. This dataset is comprised of 150 pairs of monozygotic twins (i.e. 300 samples + 10 technical replicates).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples =<span class="st"> &quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE61496&amp;targ=gsm&amp;form=text&amp;view=brief&quot;</span>
samples =<span class="st"> </span><span class="kw">readLines</span>(samples)
samples =<span class="st"> </span><span class="kw">split</span>(samples,<span class="kw">cumsum</span>(samples <span class="op">%like%</span><span class="st"> &quot;^</span><span class="ch">\\</span><span class="st">^SAMPLE = GSM&quot;</span>) )

<span class="co"># Extract GSM accessions</span>
<span class="kw">names</span>(samples) =<span class="st"> </span><span class="kw">map</span>(samples,<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">stri_match_first</span>(<span class="dt">regex=</span><span class="st">&quot;GSM</span><span class="ch">\\</span><span class="st">d+&quot;</span>)

<span class="co"># Parse meta data</span>
<span class="kw">imap</span>(samples,<span class="cf">function</span>(s,acc){
    s =<span class="st"> </span><span class="kw">strsplit</span>(s,<span class="dt">split=</span><span class="st">&quot; = &quot;</span>,<span class="dt">fixed=</span><span class="ot">TRUE</span>)  
    <span class="kw">data.table</span>(<span class="dt">gsm=</span>acc,<span class="dt">variable=</span><span class="kw">map_chr</span>(s,<span class="dv">1</span>),<span class="dt">value=</span><span class="kw">map_chr</span>(s,<span class="dv">2</span>))
}) -&gt;<span class="st"> </span>samples

samples =<span class="st"> </span><span class="kw">rbindlist</span>(samples)

<span class="co"># Keep only information on sample characteristics and supplementary files</span>
samples =<span class="st"> </span>samples[variable <span class="op">%chin%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;!Sample_characteristics_ch1&quot;</span>,<span class="st">&quot;!Sample_supplementary_file&quot;</span>)]
i =<span class="st"> </span>samples[variable <span class="op">==</span><span class="st"> &quot;!Sample_characteristics_ch1&quot;</span>,which=<span class="ot">TRUE</span>]
ch =<span class="st"> </span>samples<span class="op">$</span>value[i] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">stri_split</span>(<span class="dt">fixed=</span><span class="st">&quot;: &quot;</span>)
samples<span class="op">$</span>variable[i] =<span class="st"> </span><span class="kw">map_chr</span>(ch,<span class="dv">1</span>)
samples<span class="op">$</span>value   [i] =<span class="st"> </span><span class="kw">map_chr</span>(ch,<span class="dv">2</span>)
<span class="kw">rm</span>(ch)

<span class="co"># Find the URLs pointing to the two .idat files</span>
samples[variable<span class="op">==</span><span class="st">&quot;!Sample_supplementary_file&quot;</span> <span class="op">&amp;</span><span class="st"> </span>value <span class="op">%like%</span><span class="st"> &quot;_Red</span><span class="ch">\\</span><span class="st">.idat&quot;</span>,variable<span class="op">:</span><span class="er">=</span><span class="st">&quot;red&quot;</span>]
samples[variable<span class="op">==</span><span class="st">&quot;!Sample_supplementary_file&quot;</span> <span class="op">&amp;</span><span class="st"> </span>value <span class="op">%like%</span><span class="st"> &quot;_Grn</span><span class="ch">\\</span><span class="st">.idat&quot;</span>,variable<span class="op">:</span><span class="er">=</span><span class="st">&quot;grn&quot;</span>]

samples[variable<span class="op">==</span><span class="st">&quot;sex, 1=m, 2=f&quot;</span>,variable<span class="op">:</span><span class="er">=</span><span class="st">&quot;sex&quot;</span>]
samples[variable<span class="op">==</span><span class="st">&quot;pair id&quot;</span>,variable<span class="op">:</span><span class="er">=</span><span class="st">&quot;pair_id&quot;</span>]
samples[variable<span class="op">==</span><span class="st">&quot;birth-weight&quot;</span>,variable<span class="op">:</span><span class="er">=</span><span class="st">&quot;birth_weight&quot;</span>]

<span class="co"># Reshape data.table from long to wide format</span>
samples =<span class="st"> </span><span class="kw">dcast</span>(samples, gsm <span class="op">~</span><span class="st"> </span>variable)

samples[,sex<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(sex,<span class="dt">levels=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;m&quot;</span>,<span class="st">&quot;f&quot;</span>))]
samples<span class="op">$</span>birth_weight <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.integer</code></pre></div>
<pre><code>## Warning in function_list[[k]](value): NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples<span class="op">$</span>pair_id <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.integer</code></pre></div>
<pre><code>## Warning in function_list[[k]](value): NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples<span class="op">$</span>age <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.integer</code></pre></div>
<pre><code>## Warning in function_list[[k]](value): NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples<span class="op">$</span>tissue =<span class="st"> </span><span class="ot">NULL</span>
samples <span class="op">%&lt;&gt;%</span><span class="st"> </span>na.omit</code></pre></div>
<p>Remove technical replicates, sort by <code>pair_id</code>, and select first 20 samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">unique</span>(<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;pair_id&quot;</span>,<span class="st">&quot;birth_weight&quot;</span>))
samples =<span class="st"> </span>samples[<span class="kw">order</span>(pair_id,birth_weight)]
samples =<span class="st"> </span>samples[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</code></pre></div>
<p>Swap two samples on purpose.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swap =<span class="st"> </span>samples[<span class="dv">4</span>,<span class="kw">list</span>(red,grn)]
samples[<span class="dv">4</span>,<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;grn&quot;</span>)<span class="op">:</span><span class="er">=</span><span class="st"> </span>samples[<span class="dv">5</span>,<span class="kw">list</span>(red,grn)]]
samples[<span class="dv">5</span>,<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;grn&quot;</span>)<span class="op">:</span><span class="er">=</span><span class="st"> </span>swap]
<span class="kw">rm</span>(swap)</code></pre></div>
<p>Download the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map2</span>(samples<span class="op">$</span>red, samples<span class="op">$</span>gsm <span class="op">%s+%</span><span class="st"> &quot;_Red.idat.gz&quot;</span>, <span class="op">~</span><span class="st"> </span><span class="kw">download.file</span>(.x,.y) ) <span class="op">%&gt;%</span><span class="st"> </span>invisible
<span class="kw">map2</span>(samples<span class="op">$</span>grn, samples<span class="op">$</span>gsm <span class="op">%s+%</span><span class="st"> &quot;_Grn.idat.gz&quot;</span>, <span class="op">~</span><span class="st"> </span><span class="kw">download.file</span>(.x,.y) ) <span class="op">%&gt;%</span><span class="st"> </span>invisible
samples<span class="op">$</span>red =<span class="st"> </span><span class="ot">NULL</span>; samples<span class="op">$</span>grn =<span class="st"> </span><span class="ot">NULL</span></code></pre></div>
<p>Read in the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meth =<span class="st"> </span><span class="kw">read_idats</span>(samples<span class="op">$</span>gsm,<span class="dt">quiet=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 622399</code></pre>
<p>The first check evaluates 17 control metrics. The “Bisulfite Conversion II” metric is exemplary plotted below. 3 samples fall below 1, which is the cut-off recommended by Illumina.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ctrls =<span class="st"> </span><span class="kw">control_metrics</span>(meth)
<span class="kw">stripchart</span>(ctrls<span class="op">$</span><span class="st">`</span><span class="dt">Bisulfite Conversion II</span><span class="st">`</span>,<span class="dt">method=</span><span class="st">&quot;jitter&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">xlab=</span><span class="st">'Bisulfite Conversion II'</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))
<span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A logical vector of passed/failed is returned by <code>sample_failure()</code>. In this case, 26 samples were flagged. These samples warrant closer inspection (we’ll skip this).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sample_failure</span>(ctrls) <span class="op">%&gt;%</span><span class="st"> </span>table</code></pre></div>
<pre><code>## .
## FALSE 
##    20</code></pre>
<p>Before the next check, dye bias is corrected and beta-values are computed. No normalization is performed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meth <span class="op">%&lt;&gt;%</span><span class="st"> </span>correct_dye_bias
beta =<span class="st"> </span><span class="kw">dont_normalize</span>(meth)</code></pre></div>
<p>Sex check. The samples swapped above resulted in sex mismatches plotted in red. The actual sex of a sample donor can be inferred by calling <code>predict_sex()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples[,<span class="kw">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">check_sex</span>(meth)]

samples<span class="op">$</span>predicted_sex =<span class="st"> </span><span class="kw">predict_sex</span>(samples<span class="op">$</span>X,samples<span class="op">$</span>Y,<span class="kw">which</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">'m'</span>),<span class="kw">which</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">'f'</span>))

<span class="kw">plot</span>(X<span class="op">~</span>Y,<span class="dt">data=</span>samples,<span class="dt">pch=</span><span class="kw">ifelse</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;f&quot;</span>,<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">asp=</span><span class="dv">1</span>,<span class="dt">xlab=</span><span class="st">&quot;Normalized X chromosome intensities&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Normalized Y chromosome intensities&quot;</span>)
<span class="kw">points</span>(X<span class="op">~</span>Y,<span class="dt">data=</span>samples[sex<span class="op">!=</span>predicted_sex],<span class="dt">pch=</span><span class="kw">ifelse</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;f&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Genotype calling and classification of SNP outliers. First extract SNP probe positions from the manifest and use the matrix of beta-values as input for <code>call_genotypes</code>. This function estimates the parameters of a mixture model and returns posterior probabilities used as soft classification.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">snps =<span class="st"> </span>meth<span class="op">$</span>manifest[probe_type<span class="op">==</span><span class="st">'rs'</span>,index]
snps =<span class="st"> </span>beta[snps,]
snps =<span class="st"> </span><span class="kw">call_genotypes</span>(snps,<span class="dt">learn=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Use the classified SNPs to compare genetic fingerprints between samples. Monozygotic twins are in this check treated as one donor. List all conflicts, e.g. unexpected agreement or disagreement of fingerprints. The sample swap resulted in 8 conflicts: rows 1,4 and 5 indicate that sample #65 does not have the same fingerprint as #59, #303 and #309, even though they are supposed to come from the same donor. Analogously, row 6 indicates that sample #145 does not match the genetic fingerprint of sample #151. Rows 2,3,7 and 8 on the other hand shows the unexpected fingerprint matches between samples that are supposed to come from two different donors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">check_snp_agreement</span>(snps<span class="op">$</span>gamma,<span class="dv">1</span><span class="op">-</span>snps<span class="op">$</span>outliers,samples<span class="op">$</span>pair_id,samples<span class="op">$</span>gsm)</code></pre></div>
<pre><code>## $GSM1506278
##    donor1    sample1 donor2    sample2 similarity
## 1:      2 GSM1506277      2 GSM1506283  0.3977335
## 2:      2 GSM1506277      3 GSM1506284  0.9999997
## 3:      2 GSM1506283      3 GSM1506278  0.9999994
## 4:      3 GSM1506284      3 GSM1506278  0.3960335</code></pre>
<p>The same data can be shown as a plot. There are four (overlapping) outliers corresponding to the entries in the list above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ewastools<span class="op">:::</span><span class="kw">agreement_</span>(snps<span class="op">$</span>gamma,<span class="dv">1</span><span class="op">-</span>snps<span class="op">$</span>outliers,samples<span class="op">$</span>pair_id,samples<span class="op">$</span>gsm,<span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Unrelated&quot;</span>,<span class="st">&quot;Twins&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Check for outliers among the SNP probes. Such can indicate sample contamination or other technical problems. All 20 samples pass our recommended cut-off.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples<span class="op">$</span>log_odds =<span class="st"> </span><span class="kw">snp_outliers</span>(snps)
<span class="kw">table</span>(samples<span class="op">$</span>log_odds <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">4</span>)</code></pre></div>
<pre><code>## 
## FALSE 
##    20</code></pre>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
