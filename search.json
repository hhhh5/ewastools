[{"path":"https://hhhh5.github.io/ewastools/articles/exemplary_ewas.html","id":"quality-checks","dir":"Articles","previous_headings":"","what":"Quality checks","title":"Recommended Work Flow","text":"Control metrics first quality check evaluates 17 control metrics describe BeadArray Controls Reporter Software Guide Illumina. Exemplary, “Bisulfite Conversion II” metric plotted . Three samples fall Illumina-recommended cut-1. Input control_metrics() output read_idats(), e.g. object holding raw dye-bias-corrected intensities.  logical vector passed/failed returned sample_failure() compares 21 metrics thresholds recommended Illumina. case several samples fail.. Sex mismatches sex sample donor can reliable inferred methylation data. functionality implemented combination check_sex() predict_sex(). check_sex() computes normalized average total fluorescence intensities probes targeting X Y chromosome. predict_sex() uses output check_sex() recorded sex order identify mislabeled samples. function check_sex() applied dye-bias corrected intensities. Important: test performed using dye-bias corrected intensities masking undetected probes, step mask many Y chromosome probes used . Plotted normalized average total fluorescence intensities X Y chromosome probes.  Samples form two cluster males (top left) females (bottom left). one mislabeled sample (red) can easily identified flagged. Another sample falls outside two clusters. several possible explanations samples clustering males females, example chromosome abnormalities. sample contamination. latter theory can tested next quality check. Genotype calling outliers next check first need row indexes SNP probes beta. meth, output read_idats(), contains data.table object relevant information. SNP probes labelled \"rs\". SNPs used input call_genotypes(). function estimates parameters mixture model consisting three Beta distributions representing heterozygous two homozygous genotypes, fourth component, uniform distribution, representing outliers. functions returns posterior probabilities used soft classification. setting argument learn=FALSE, pre-specified mixture model used. case, use pre-specified model dataset quite small maximum likelihood estimation might unstable. snp_outliers() returns average log odds belonging outlier component across SNP probes. recommend flag samples score greater -4 exclusion. one sample failing check sample belong either male female cluster plot . strong evidence sample indeed contaminated. SNP outliers can also result poorly performing assays, sample passed first quality check looking control metrics, therefore rendering possibility unlikely. Another cause high outlier score sample degradation (e.g., FFPE samples). useful functions mentioned check_snp_agreement() enumerate_sample_donors(). former checks whether genotypes samples supposed come donor (monozygotic twins) fact agree; latter returns unique IDs unique genotypes can, example, used find technical replicates public datasets. [Note] calling check_snp_agreement() recommend run function samples outlier metric -2, .e., greater cut--4 used exclude contaminated samples, still small enough guarantee SNP calls accurate. samples GSM2260485 GSM2260543 come donor. PCA Principal component analysis popular feature reduction method: projects high-dimensional data lower-dimensional representation trying retain much variability possible. especially useful either individual features highly correlated therefore reasonable summarize , (sometimes subtle) traces background effects can found across large number features. drop X Y chromosome like find important drivers methylation beyond sex.  one clear outlier. GSM2219539 actually lung tissue sample another GEO dataset (included educational purposes). dominates first principal component excluded otherwise drastically change results downstream analyses. PCA may applied iteratively. excluding samples manifest outliers, repeating PCA can give different principal components. Leukocyte composition quality check apply case blood samples (blood , however, one commonly studied tissues). function estimateLC() implements Houseman method predict leukocyte composition. user choice various sets model parameters trained various reference datasets (see ?estimateLC list options). function operates matrix beta-values. LC contains estimated proportions seven cell types (dependent chosen reference dataset). second foreign sample another GEO dataset hidden dataset, consisting purified fraction granulocytes. Plotting NE + EO + BA sample can easily spotted.  third last sample, GSM1185585. lung sample also prominent, estimated proportion GR (exactly numerical issues) zero. drop problematic samples","code":"ctrls = control_metrics(meth) stripchart(ctrls$`Bisulfite Conversion II`,method=\"jitter\",pch=4,xlab='Bisulfite Conversion II',xlim=c(0,10)) abline(v=1,col=2,lty=3) pheno$failed = sample_failure(ctrls) table(pheno$failed) ##  ## FALSE  TRUE  ##    26     9 pheno[,c(\"X\",\"Y\") := check_sex(meth)] pheno[,predicted_sex:=predict_sex(X,Y,which(sex==\"m\"),which(sex==\"f\"))]  tmp = pheno[predicted_sex==sex] plot(Y ~ X,data=tmp,pch=ifelse(tmp$sex==\"f\",1,4),asp=1,xlab=\"Normalized X chromosome intensities\",ylab=\"Normalized Y chromosome intensities\") tmp = pheno[predicted_sex!=sex] points(Y ~ X,data=tmp,pch=ifelse(tmp$sex==\"f\",1,4),col=2) legend(\"topright\",pch=c(1,4),legend=c(\"female\",\"male\")) pheno[sex!=predicted_sex,exclude:=TRUE] # flag sample pheno[sex!=predicted_sex,.(gsm,sex,predicted_sex)] ##           gsm    sex predicted_sex ##        <char> <char>        <fctr> ## 1: GSM2260573      f             m pheno[X %between% c(0.85,0.95) & Y %between% c(0.65,0.75),.(gsm,X,Y,sex,predicted_sex)] ##           gsm         X         Y    sex predicted_sex ##        <char>     <num>     <num> <char>        <fctr> ## 1: GSM2260653 0.9266193 0.7212944      m             m meth$manifest ## Index: <channel> ##            ilmn_id   probe_id addressU addressM probe_design next_base channel ##             <char>     <char>    <int>    <int>       <fctr>    <fctr>  <fctr> ##      1: cg00035864 cg00035864 31729416       NA           II      <NA>    Both ##      2: cg00050873 cg00050873 32735311 31717405            I         A     Red ##      3: cg00061679 cg00061679 28780415       NA           II      <NA>    Both ##      4: cg00063477 cg00063477 16712347       NA           II      <NA>    Both ##      5: cg00121626 cg00121626 19779393       NA           II      <NA>    Both ##     ---                                                                        ## 485573:  rs7746156  rs7746156 33622366       NA           II      <NA>    Both ## 485574:  rs1945975  rs1945975 23614475       NA           II      <NA>    Both ## 485575:   rs966367   rs966367 16795360       NA           II      <NA>    Both ## 485576:   rs877309   rs877309 54760445       NA           II      <NA>    Both ## 485577:  rs4331560  rs4331560 10654345       NA           II      <NA>    Both ##            chr  mapinfo probe_rep probe_type  index  OOBi     Ui     Mi ##         <fctr>    <int>     <int>     <fctr>  <int> <int>  <int>  <int> ##      1:   chrY  8553009         1         cg      1    NA 210047 210047 ##      2:   chrY  9363356         1         cg      2     1 219718 209461 ##      3:   chrY 25314171         1         cg      3    NA 182665 182665 ##      4:   chrY 22741795         1         cg      4    NA  62991  62991 ##      5:   chrY 21664296         1         cg      5    NA  95405  95405 ##     ---                                                                 ## 485573:   <NA>       NA         1         rs 485573    NA 224103 224103 ## 485574:   <NA>       NA         1         rs 485574    NA 126234 126234 ## 485575:   <NA>       NA         1         rs 485575    NA  66829  66829 ## 485576:   <NA>       NA         1         rs 485576    NA 431915 431915 ## 485577:   <NA>       NA         1         rs 485577    NA   2441   2441 snps = meth$manifest[probe_type==\"rs\",index] snps = beta[snps,] genotypes = call_genotypes(snps,learn=FALSE) pheno$outlier = snp_outliers(genotypes) pheno[outlier > -4,.(gsm,X,Y,outlier)] ##           gsm         X         Y    outlier ##        <char>     <num>     <num>      <num> ## 1: GSM2260653 0.9266193 0.7212944 -0.8460863 pheno[outlier > -4,exclude:=TRUE] # flag sample pheno$donor_id = enumerate_sample_donors(genotypes)  # List duplicates pheno[,n:=.N,by=donor_id] pheno[n>1,.(gsm,donor_id)] ##           gsm donor_id ##        <char>    <num> ## 1: GSM2260485        3 ## 2: GSM2260543        3 pheno[gsm==\"GSM2260543\",exclude:=TRUE] # drop duplicate set.seed(982278) chrXY = meth$manifest[chr %in% c(\"chrX\",\"chrY\") & probe_type != \"rs\", index] pcs = beta[-chrXY, ] pcs = pcs - rowMeans(pcs) pcs = na.omit(pcs) pcs = t(pcs) pcs = trlan.svd(pcs,neig=2) # compute the first two principal components pcs = pcs$u  pheno$pc1 = pcs[, 1] pheno$pc2 = pcs[, 2] plot(pc2 ~ pc1,pch=ifelse(sex==\"f\",1,4),pheno,asp=1,xlab=\"PC #1\",ylab=\"PC #2\") legend(\"topright\",pch=c(1,4),legend=c(\"female\",\"male\")) pheno[pc1< -0.8,exclude:=TRUE] pheno[pc1< -0.8,.(gsm,pc1,pc2)] ##           gsm        pc1        pc2 ##        <char>      <num>      <num> ## 1: GSM2219539 -0.9300883 -0.1484162 LC = estimateLC(beta,ref=\"HRS\") pheno = cbind(pheno,LC) round(head(LC),3) ##       NE    EO    BA    MO EM_CT CM_CT  E_CT  N_CT EM_HT CM_HT  E_HT  N_HT ##    <num> <num> <num> <num> <num> <num> <num> <num> <num> <num> <num> <num> ## 1: 0.877 0.011 0.000 0.049 0.016 0.006 0.000 0.018     0 0.025 0.000 0.000 ## 2: 0.807 0.007 0.016 0.068 0.002 0.001 0.030 0.017     0 0.019 0.000 0.045 ## 3: 0.888 0.000 0.003 0.033 0.009 0.000 0.000 0.030     0 0.010 0.000 0.000 ## 4: 0.785 0.036 0.013 0.075 0.029 0.010 0.000 0.017     0 0.045 0.000 0.000 ## 5: 0.752 0.024 0.004 0.078 0.003 0.001 0.010 0.026     0 0.042 0.000 0.060 ## 6: 0.783 0.014 0.027 0.050 0.032 0.004 0.006 0.011     0 0.034 0.002 0.032 ##        B    DC    NK ##    <num> <num> <num> ## 1: 0.007 0.000 0.000 ## 2: 0.003 0.000 0.007 ## 3: 0.011 0.012 0.020 ## 4: 0.000 0.000 0.010 ## 5: 0.009 0.000 0.007 ## 6: 0.006 0.000 0.007 plot(pheno[,NE+EO+BA]*100,ylab=\"Granulocyte fraction (%)\") pheno[which.max(NE), .(gsm, NE)] ##           gsm       NE ##        <char>    <num> ## 1: GSM1185585 1.009256 pheno[which.max(NE), exclude := TRUE] pheno[which.min(NE), .(gsm, NE)] ##           gsm        NE ##        <char>     <num> ## 1: GSM2219539 0.1763932 pheno[which.min(NE), exclude := TRUE] drop  = pheno[exclude==TRUE,which=TRUE] pheno = pheno[ -drop] beta  = beta [,-drop] meth %<>% drop_samples(j=drop)"},{"path":"https://hhhh5.github.io/ewastools/articles/exemplary_ewas.html","id":"ewas","dir":"Articles","previous_headings":"","what":"EWAS","title":"Recommended Work Flow","text":"’ve cleaned pre-processed data, now time actual EWAS. First important correctly code variables. smoker sex vectors type character, converted factors. want test CpG sites association smoking. Unfortunately, phenotype data sparse, typcial public datasets. Aside smoking, sex estimated proportions seven cell types including model. following code snippet optimized readability speed. create data.table holding p-values information probes. Two significant CpGs (cg01940273, cg05575921) known biomarkers overlapping genes (ALPPL2, AHRR) association smoking validated several cohorts (Zeilinger et. al., 2013).","code":"pheno = pheno[,.(      gsm     ,sex = factor(sex,levels=c(\"m\",\"f\")) # first level is the reference     ,smoker = factor(smoker,levels=c(\"non-smoker\",\"smoker\"))     ,NE, MO, B, EO, BA, NK )] f = function(meth){     m = lm(meth ~ 1 + sex + smoker + NE + MO + B + EO + BA + NK, data=pheno)     coef(summary(m))[\"smokersmoker\",4] # extract the p-value for the smoking }  f = possibly(f,otherwise=NA_real_) # catch errors  pvals = apply(beta,1,f) SMK = data.table(probe_id=rownames(beta),pval=pvals) SMK %<>% na.omit SMK[,qval:=p.adjust(pval,m=\"fdr\")] SMK = SMK[qval<0.05] print(SMK) ##       probe_id         pval        qval ##         <char>        <num>       <num> ##  1: cg06882199 7.348569e-07 0.039618668 ##  2: cg01940273 1.389297e-08 0.002247054 ##  3: cg05951221 2.380479e-07 0.019250971 ##  4: cg21566642 7.874678e-09 0.002247054 ##  5: cg05575921 4.688252e-08 0.005687096 ##  6: cg14580211 2.051527e-07 0.019250971 ##  7: cg21161138 1.162694e-08 0.002247054 ##  8: cg25845688 1.247851e-06 0.049582165 ##  9: cg16571007 9.630933e-07 0.046731311 ## 10: cg02610360 1.161149e-06 0.049582165 ## 11: cg03099988 3.273600e-07 0.019855241 ## 12: cg16497398 1.328401e-06 0.049582165 ## 13: cg03636183 3.261651e-07 0.019855241"},{"path":"https://hhhh5.github.io/ewastools/articles/exemplary_ewas.html","id":"final-comments","dir":"Articles","previous_headings":"","what":"Final comments","title":"Recommended Work Flow","text":"Depending dataset, many types quality checks might applicable. suggestions comments regarding ewastools, please send email, file issue submit pull request GitHub (https://github.com/hhhh5/ewastools).","code":""},{"path":"https://hhhh5.github.io/ewastools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathan Alexander Heiss. Maintainer.","code":""},{"path":"https://hhhh5.github.io/ewastools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Just AC, Heiss JA (2025). ewastools: EWAS Tools. R package version 1.8.0, https://hhhh5.github.io/ewastools/.","code":"@Manual{,   title = {ewastools: EWAS Tools},   author = {Allan C. Just and Jonathan Alexander Heiss},   year = {2025},   note = {R package version 1.8.0},   url = {https://hhhh5.github.io/ewastools/}, }"},{"path":"https://hhhh5.github.io/ewastools/index.html","id":"ewas_tools-a-quality-control-toolset-for-the-illumina-infinium-dna-methylation-platforms-doi","dir":"","previous_headings":"","what":"EWAS Tools","title":"EWAS Tools","text":"following functionality offered 450K EPIC chips: Screen problematic samples, e.g. failed assays, mislabeled contaminated samples (control_metrics, check_sex, snp_outliers). Compute detection p-values mask respective data points (detectionP, mask). Preprocess data (correct_dye_bias, dont_normalize). Estimate leukocyte composition case blood samples (estimateLC) Read vignette recommended QC workflow https://hhhh5.github.io/ewastools/articles/exemplary_ewas.html. Package documentation available https://hhhh5.github.io/ewastools/. open access paper describing quality checks implemented package detail available http://doi.org/10.1186/s13148-018-0504-1. vignette demonstrating application quality control checks public dataset provided well. second paper (open access) describing improved detection p-values implemented ewastools can found https://doi.org/10.1186/s13148-019-0615-3. installation please run devtools::install_github(\"hhhh5/ewastools\")","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/MethylationScores.html","id":null,"dir":"Reference","previous_headings":"","what":"Various methylation scores — methylation_score","title":"Various methylation scores — methylation_score","text":"Various methylation scores","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/MethylationScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Various methylation scores — methylation_score","text":"","code":"methylation_score(beta, model)"},{"path":"https://hhhh5.github.io/ewastools/reference/MethylationScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Various methylation scores — methylation_score","text":"beta matrix beta values model Name model, .e., one `maternal_smoking`, `gestational_age`, `horvath_clock`","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions for preprocessing — Preprocessing","title":"Functions for preprocessing — Preprocessing","text":"Functions preprocessing","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions for preprocessing — Preprocessing","text":"","code":"correct_dye_bias(raw)  correct_dye_bias2(raw)  dont_normalize(raw)"},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions for preprocessing — Preprocessing","text":"raw Output calling read_idats tissue Optional. set \"blood\", predefined reference values used normalization. Recommened cell proportions estimated.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions for preprocessing — Preprocessing","text":"modified raw object dye-bias corrected intensities using RELIC correct_dye_bias. matrix beta-values, either normalized (normalize) (dont_normalize).","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functions for preprocessing — Preprocessing","text":"Xu Z, Langie SA, De Boever P, Taylor JA, Niu L. RELIC: novel dye-bias correction method Illumina Methylation BeadChip. BMC Genomics. 2017 Jan 3;18(1):4. Heiss JA, Brenner H. -array normalization 450K data. Frontiers Genetics. 2015;6.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/Preprocessing.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions for preprocessing — Preprocessing","text":"Jonathan Heiss","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/call_genotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Genotype calling — call_genotypes","title":"Genotype calling — call_genotypes","text":"Detect SNP probes fit three categories (AA,AB,BB). mixture model (3 Beta distributions, 1 uniform distribution outliers) fitted SNP probes. learning model parameters via EM algorithm, probability outlier computed SNP.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/call_genotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genotype calling — call_genotypes","text":"","code":"call_genotypes(snpmatrix, learn = FALSE, maxiter = 50)  mxm_(genotypes)  snp_outliers(genotypes)  eBeta(x, w)"},{"path":"https://hhhh5.github.io/ewastools/reference/call_genotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genotype calling — call_genotypes","text":"snpmatrix Matrix beta-values SNP probes. Provide SNPs probes rows samples columns. maxiter Maximal number iterations Expectation-Maximization algorithm learning mixture model genotypes Output call_genotypes","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/call_genotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genotype calling — call_genotypes","text":"call_genotypes, list containing par Parameters mixture model loglik Log-likelihood iteration EM algorithm outliers -posteriori probability SNP outlier gamma -posteriori probabilities three genotypes snp_outliers, metric assessing outlierness SNP beta-values. High values may indicate either contaminated failed samples. mxm_, histogram showing distribution beta-values SNP probes density function mixture model overlaid.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/call_genotypes.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Genotype calling — call_genotypes","text":"Jonathan . Heiss","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/cell_composition.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell composition — estimateLC","title":"Cell composition — estimateLC","text":"Estimation cell proportions blood saliva using Houseman algorithm","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/cell_composition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell composition — estimateLC","text":"","code":"estimateLC(meth, ref, constrained = FALSE)"},{"path":"https://hhhh5.github.io/ewastools/reference/cell_composition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell composition — estimateLC","text":"meth Matrix beta values ref Choice reference dataset: available options `HRS` (Health Retirement Study), `Reinius` [2]`, Bakulski` [3], `deGoede` [4], `Gervin`[5], `Lin` [6], `Mill` [GSE103541], `Salas` [7], `Lolipop` [8] combinations , concatenated `+`, e.g. `Reinius+Lin` (might flip first second name)). Furthermore, option `saliva` `salivaEPIC` available [9]. constrained Force cell proportions sum 1.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/cell_composition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell composition — estimateLC","text":"Estimated cell proportions B-lymphocytes, CD4 T-cells, CD8 T-cells, granulocytes, monocytes,  natural killer cells (nucleated red blood cells) using Houseman algorithm [1]. Models trained various reference datasets purified cell types.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/cell_composition.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cell composition — estimateLC","text":"Houseman EA, et al. DNA methylation arrays surrogate measures cell mixture distribution. BMC bioinformatics. 2012 Dec 1;13(1):86. Reinius LE, et al. Differential DNA methylation purified human blood cells: implications cell lineage studies disease susceptibility. PloS one. 2012 Jul 25;7(7):e41361. Bakulski KM, et al. DNA methylation cord blood cell types: applications mixed cell birth studies. Epigenetics. 2016 May 3;11(5):354-62. de Goede OM, et al. Nucleated red blood cells impact DNA methylation expression analyses cord blood hematopoietic cells. Clinical epigenetics. 2015 Dec;7(1):95. Gervin K, et al. Cell type specific DNA methylation cord blood: 450K-reference data set cell count-based validation estimated cell type composition. Epigenetics. 2016 Sep 1;11(9):690-8 Gervin K, et al. Systematic evaluation validation reference library selection methods deconvolution cord blood DNA methylation data. bioRxiv. 2019 March; DOI:10.1101/570457 Salas LA, et al. optimized library reference-based deconvolution whole-blood biospecimens assayed using Illumina HumanMethylationEPIC BeadArray. Genome biology. 2018 Dec;19(1):64. Heiss JA, et al. Training model estimating leukocyte composition using whole-blood DNA methylation cell counts reference. Epigenomics. 2017 Jan;9(1):13-20. Middleton LYM, et al. Saliva cell type DNA methylation reference panel epidemiology studies children. 2020 Sep;","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer the sex of sample donor — check_sex","title":"Infer the sex of sample donor — check_sex","text":"Return normalized average total intensities probes targeting X Y chromosomes.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer the sex of sample donor — check_sex","text":"","code":"check_sex(raw)  predict_sex(X, Y, male, female)"},{"path":"https://hhhh5.github.io/ewastools/reference/check_sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer the sex of sample donor — check_sex","text":"raw Output calling read_idats X, Y Forwarded check_sex male, female Indices male female samples","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer the sex of sample donor — check_sex","text":"check_sex returns normalized average total intensities probes targeting X Y chromosomes. forwarded predict_sex returns factor levels \"f\",\"m\" (NA sex determined conclusively).","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_snp_agreement.html","id":null,"dir":"Reference","previous_headings":"","what":"Agreement of SNPs — check_snp_agreement","title":"Agreement of SNPs — check_snp_agreement","text":"function check agreement genetic fingerprints samples (genotype calling call_genotypes). case check_snp_agreement, user supplies sample assumed donor ID function returns conflicts (.d., either samples supposed come donor distinct genetic fingerprints samples supposedly different donors fingerprints). check_snp_agreement hand inferring donor IDs case unknown (useful example detect technical replicates public dataset).","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_snp_agreement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Agreement of SNPs — check_snp_agreement","text":"","code":"check_snp_agreement(genotypes, donor_ids, sample_ids)  agreement_(genotypes, donor_ids, sample_ids, ...)  enumerate_sample_donors(genotypes)"},{"path":"https://hhhh5.github.io/ewastools/reference/check_snp_agreement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Agreement of SNPs — check_snp_agreement","text":"genotypes Output call_genotypes donor_ids Vector donor IDs, include duplicates sample_ids Vector unique sample IDs","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_snp_agreement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Agreement of SNPs — check_snp_agreement","text":"check_snp_agreement returns conflicts found user-supplied donor IDs derived genetic fingerprint. Either NULL conflicts found, list data.tables, representing one connected component conflict graph. enumerate_sample_donors returns sample donor IDs.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/check_snp_agreement.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Agreement of SNPs — check_snp_agreement","text":"Jonathan . Heiss","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/control_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Quality control metrics — control_metrics","title":"Quality control metrics — control_metrics","text":"Calculate QC metrics described 'BeadArray Controls Reporter Software Guide' Illumina.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/control_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quality control metrics — control_metrics","text":"","code":"control_metrics(raw)  sample_failure(metrics)"},{"path":"https://hhhh5.github.io/ewastools/reference/control_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quality control metrics — control_metrics","text":"raw Output calling read_idats metrics Output callling control_metrics","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/control_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quality control metrics — control_metrics","text":"control_metrics, list 17 control metrics, one numeric vector equal length sample size sample_failure, logical vector, TRUE sample corresponding index failed 17 control metrics.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/control_metrics.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Quality control metrics — control_metrics","text":"can download Software Guide https://support.illumina.com/downloads/beadarray-controls-reporter-software-guide-1000000004009.html","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":null,"dir":"Reference","previous_headings":"","what":"Detection p-values — summits","title":"Detection p-values — summits","text":"Compute detection p-values. p-values based distribution intensities negative control probes U (M) intensities observed completely methylated (unmethylated) probes, respectively (Heiss Just, 2019). detP_threshold generates plot showing number undetected Y chromosome probes among male female subjects various p-value thresholds, order empirically choose threshold. Finally, mask masking probes detection p-values specified threshold. detectionP.minfi provides implementation RGChannelSet objects used minfi package.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detection p-values — summits","text":"","code":"summits(beta)  detectionP(raw)  detectionP.neg(raw)  mask(raw, threshold)  eval_detP_cutoffs(raw, males = NULL, females = NULL)  detectionP.minfi(rgSet)"},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detection p-values — summits","text":"raw Output calling read_idats, must include component detP mask detP_threshold. threshold p-value threshold (arithmetic scale) oberservations set NA. rgSet minfi rgSet object male/female Indices male female subjects","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detection p-values — summits","text":"detectionP detectionP.neg modified raw object detP component, matrix detection p-values, added. detectionP computes p-values linear scale, whereas detectionP.neg returns p-values log10 scale. detectionP.minfi matrix detection p-values. mask, modified raw object, undetected probes set NA. Vector length two","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Detection p-values — summits","text":"Heiss JA, Just AC. Improved filtering DNA methylation microarray data detection p values impact downstream analyses. Clinical Epigenetics (2019) 11:15 Return peaks beta-value distribution Return locations two peaks (completly methylated unmethylated CpG sites) beta-value distribution.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/detectionP.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Detection p-values — summits","text":"Jonathan . Heiss","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/drop_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop samples from raw data. — drop_samples","title":"Drop samples from raw data. — drop_samples","text":"Drop samples raw data.","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/drop_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop samples from raw data. — drop_samples","text":"","code":"drop_samples(raw, j = NULL)"},{"path":"https://hhhh5.github.io/ewastools/reference/drop_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop samples from raw data. — drop_samples","text":"raw Output calling read_idats j Indices samples drop","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/drop_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Drop samples from raw data. — drop_samples","text":"modified raw object","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/drop_samples.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Drop samples from raw data. — drop_samples","text":"Jonathan . Heiss","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/read_idats.html","id":null,"dir":"Reference","previous_headings":"","what":"Read .idat files — read_idats","title":"Read .idat files — read_idats","text":"Read .idat files","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/read_idats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read .idat files — read_idats","text":"","code":"read_idats(idat_files, quiet = FALSE)"},{"path":"https://hhhh5.github.io/ewastools/reference/read_idats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read .idat files — read_idats","text":"idat_files Character vector relative absolute filepaths, without suffixes '_Grn.idat' '_Red.idat'. IDATs red green channel must prefix stored folder. E.g., sample idats 200607110235_R01C01_Red.idat 200607110235_R01C01_Grn.idat passed read_idats \"200607110235_R01C01\". quiet TRUE, suppresses progress bar (useful RMarkdown scripts).","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/read_idats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read .idat files — read_idats","text":"list containing manifest data.table describing probes M intensities targeting methylated sequences U intensities targeting unmethylated sequences N number beads average intensities M derived V number beads average intensities U derived ctrlG Intensities control probes green color channel ctrlR Intensities control probes red color channel meta data.table containing unique sample_ids metadata","code":""},{"path":"https://hhhh5.github.io/ewastools/reference/read_idats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read .idat files — read_idats","text":"","code":"if (FALSE) { # \\dontrun{ read_idats('9976861004_R01C01') } # }"},{"path":"https://hhhh5.github.io/ewastools/news/index.html","id":"ewastools-180","dir":"Changelog","previous_headings":"","what":"ewastools 1.8.0","title":"ewastools 1.8.0","text":"Removed deconvolution models based combinations two datasets Improved support EPICv2 chip, adding function handle new probe IDs Refactored parsing manifests files","code":""},{"path":"https://hhhh5.github.io/ewastools/news/index.html","id":"ewastools-172","dir":"Changelog","previous_headings":"","what":"ewastools 1.7.2","title":"ewastools 1.7.2","text":"Added support EPICv2 chip","code":""},{"path":"https://hhhh5.github.io/ewastools/news/index.html","id":"ewastools-171","dir":"Changelog","previous_headings":"","what":"ewastools 1.7.1","title":"ewastools 1.7.1","text":"Added HRS cell composition model","code":""},{"path":"https://hhhh5.github.io/ewastools/news/index.html","id":"ewastools-17","dir":"Changelog","previous_headings":"","what":"ewastools 1.7","title":"ewastools 1.7","text":"Saliva cell composition prediction Test detectionP.minfi compatibility Drop normalize","code":""},{"path":"https://hhhh5.github.io/ewastools/news/index.html","id":"ewastools-16","dir":"Changelog","previous_headings":"","what":"ewastools 1.6","title":"ewastools 1.6","text":"read_idats: extract Sentrix barcode position .idat files, stored meta data.table (92eb8df289a473fa0c06471be197db1953e39efd0) call_genotypes: use pre-specified parameters SNP mixture model default, .e., learn=FALSE (507abceeb8db572d72089e423678f3cd5a7f6769) Update recommedation pre-processing workflow: call mask() check_sex() (eb54d1b0d74d2b0231db6e03a8c60710abd42e09) Add unit tests Fix: bisulfite conversion control probes ignored due inconsistent naming (24233ffcbea4337b9a7d4d3060b03b484d5ba01c)","code":""}]
